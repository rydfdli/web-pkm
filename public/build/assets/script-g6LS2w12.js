document.addEventListener("DOMContentLoaded",function(){b()});function b(){l(),d(),g(),v(),w(),L(),y()}function l(){document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",function(e){e.preventDefault();const o=this.getAttribute("href"),i=document.querySelector(o);if(i){const s=i.offsetTop-80;window.scrollTo({top:s,behavior:"smooth"});const n=document.querySelector(".navbar-collapse");n.classList.contains("show")&&new bootstrap.Collapse(n).hide()}})})}function d(){window.addEventListener("scroll",function(){const t=document.querySelectorAll("section[id]"),e=document.querySelectorAll(".navbar-nav .nav-link:not(.dropdown-toggle)"),o=document.querySelectorAll(".dropdown-item"),i=window.pageYOffset||document.documentElement.scrollTop;let s="";t.forEach(n=>{const c=n.offsetTop-100,r=c+n.offsetHeight;i>=c&&i<r&&(s=n.getAttribute("id"))}),e.forEach(n=>{n.classList.remove("active")}),o.forEach(n=>{n.classList.remove("active")}),e.forEach(n=>{n.getAttribute("href")==="#"+s&&n.classList.add("active")}),o.forEach(n=>{if(n.getAttribute("href")==="#"+s){n.classList.add("active");const r=document.querySelector("#profilDropdown");r&&r.classList.add("active")}})})}function g(){const t={threshold:.1,rootMargin:"0px 0px -50px 0px"},e=new IntersectionObserver(function(i){i.forEach(s=>{if(s.isIntersecting&&(s.target.classList.add("fade-in-up"),s.target.classList.contains("service-card")||s.target.classList.contains("news-card"))){const n=Array.from(s.target.parentNode.children).indexOf(s.target)*100;s.target.style.animationDelay=n+"ms"}})},t);document.querySelectorAll(".service-card, .news-card, .section-title, .hero-content").forEach(i=>{e.observe(i)})}function v(){const t=document.querySelector(".navbar-toggler"),e=document.querySelector(".navbar-collapse");document.addEventListener("click",function(o){!t.contains(o.target)&&!e.contains(o.target)&&e.classList.contains("show")&&new bootstrap.Collapse(e).hide()})}function w(){const t=document.querySelector(".hero-content");t&&setTimeout(()=>{t.classList.add("fade-in-up")},200),x()}function x(){const t=document.querySelectorAll(".fw-bold.text-primary"),e=200,o={threshold:.7},i=new IntersectionObserver(function(s){s.forEach(n=>{if(n.isIntersecting){const c=n.target,r=parseInt(c.textContent.replace(/[^0-9]/g,"")),p=r/e;let a=0;const m=setInterval(()=>{a+=p,a>=r&&(a=r,clearInterval(m));const h=c.textContent.includes("+")?"+":"";c.textContent=Math.floor(a).toLocaleString()+h},10);i.unobserve(c)}})},o);t.forEach(s=>{i.observe(s)})}function L(){const t=document.querySelector("#contactForm");t&&t.addEventListener("submit",function(e){e.preventDefault(),T(this)})}function T(t){const e=t.querySelector('button[type="submit"]'),o=e.textContent;e.textContent="Mengirim...",e.disabled=!0,setTimeout(()=>{u("Pesan berhasil dikirim! Kami akan menghubungi Anda segera.","success"),t.reset(),e.textContent=o,e.disabled=!1},2e3)}function u(t,e="info"){const o=document.createElement("div");o.className=`alert alert-${e} alert-dismissible fade show position-fixed`,o.style.cssText="top: 100px; right: 20px; z-index: 9999; min-width: 300px;",o.innerHTML=`
        ${t}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `,document.body.appendChild(o),setTimeout(()=>{o.parentNode&&o.remove()},5e3)}function y(){const t=document.createElement("button");t.innerHTML='<i class="fas fa-arrow-up"></i>',t.className="btn btn-primary back-to-top",t.style.cssText=`
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: none;
        z-index: 1000;
        border: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        transition: all 0.3s ease;
    `,document.body.appendChild(t),window.addEventListener("scroll",function(){window.pageYOffset>300?t.style.display="block":t.style.display="none"}),t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}function f(t,e){let o;return function(...s){const n=()=>{clearTimeout(o),t(...s)};clearTimeout(o),o=setTimeout(n,e)}}const E=f(function(){},16);window.addEventListener("scroll",E);window.addEventListener("resize",f(function(){console.log("Window resized")},250));function C(){["https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=400&h=250&fit=crop","https://images.unsplash.com/photo-1609840114035-3c981b782dfe?w=400&h=250&fit=crop","https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop"].forEach(e=>{const o=new Image;o.src=e})}C();"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(t){console.log("ServiceWorker registration successful")}).catch(function(t){console.log("ServiceWorker registration failed")})});window.PuskesmasApp={showNotification:u,initSmoothScrolling:l,initActiveNavigation:d};
