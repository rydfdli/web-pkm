document.addEventListener("DOMContentLoaded",function(){d(),l(),u()});function d(){const t=document.getElementById("searchInput"),e=document.getElementById("searchBtn"),n=document.getElementById("categoryFilter"),i=document.querySelector('form[action*="news"]');if(!t||!e||!n||!i)return;e.addEventListener("click",function(a){a.preventDefault(),c()}),t.addEventListener("keypress",function(a){a.key==="Enter"&&(a.preventDefault(),c())});let o;t.addEventListener("input",function(){clearTimeout(o);const a=this.value.trim();(a.length>=2||a.length===0)&&(o=setTimeout(()=>{c()},800))}),n.addEventListener("change",function(){c()})}function l(){document.querySelectorAll(".category-list a").forEach(e=>{e.addEventListener("click",function(n){r(!0)})})}function u(){const t=document.querySelector('form[action*="news"]');t&&t.addEventListener("submit",function(e){r(!0);const n=new FormData(this),i=n.get("search"),o=n.get("kategori");if(!i||i.trim()===""){const a=this.querySelector('input[name="search"]');a&&a.removeAttribute("name")}if(!o){const a=this.querySelector('select[name="kategori"]');a&&a.removeAttribute("name")}})}function c(){const t=document.querySelector('form[action*="news"]');if(!t)return;r(!0);const e=t.querySelector('input[name="search"]');t.querySelector('select[name="kategori"]'),e&&e.value&&(e.value=e.value.trim()),t.submit()}function r(t){const e=document.getElementById("searchBtn"),n=document.getElementById("searchInput"),i=document.getElementById("categoryFilter");t?(e&&(e.disabled=!0,e.innerHTML='<i class="fas fa-spinner fa-spin me-1"></i>Mencari...'),n&&(n.disabled=!0),i&&(i.disabled=!0),s(!0)):(e&&(e.disabled=!1,e.innerHTML='<i class="fas fa-search me-1"></i>Cari'),n&&(n.disabled=!1),i&&(i.disabled=!1),s(!1))}function s(t){let e=document.getElementById("searchLoadingOverlay");if(t){if(!e){e=document.createElement("div"),e.id="searchLoadingOverlay",e.className="search-loading-overlay",e.innerHTML=`
                <div class="d-flex justify-content-center align-items-center h-100">
                    <div class="text-center">
                        <div class="spinner-border text-primary mb-3" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <div class="text-muted">Mencari berita...</div>
                    </div>
                </div>
            `;const n=document.getElementById("newsContainer");n&&(n.parentNode.style.position="relative",n.parentNode.appendChild(e))}e.style.display="flex"}else e&&(e.style.display="none")}function m(){const t=window.location.pathname;window.location.href=t}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".pagination .page-link").forEach(e=>{e.addEventListener("click",function(){r(!0)})})});window.addEventListener("popstate",function(t){r(!0)});document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("searchInput"),e=new URLSearchParams(window.location.search);t&&!e.get("search")&&t.focus()});function f(){const t=new URLSearchParams(window.location.search);return{search:t.get("search")||"",kategori:t.get("kategori")||""}}window.NewsSearch={submitSearch:c,clearAllFilters:m,getCurrentSearchParams:f,showLoadingState:r};
